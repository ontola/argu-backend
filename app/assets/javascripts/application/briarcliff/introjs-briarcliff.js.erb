$(function() {

    introJsOptions = {
        'skipLabel': '<%= I18n.t('intro.skip') %>',
        'nextLabel': '<%= I18n.t('intro.next') %>',
        'prevLabel': '<%= I18n.t('intro.previous') %>',
        'doneLabel': '<%= I18n.t('intro.done') %>',
        'disableInteraction': false,
        'showBullets': true,
        'showProgress': false,
        'showStepNumbers': false,
        'scrollToElement': true
    };

    introJsMotionTour = introJs().setOptions(introJsOptions).setOptions({
        steps:[
            {
                element: document.querySelector('.motion-body'),
                intro: "<%= I18n.t('intro.motion.posted.body') %>"
            },
            {
                element: document.querySelector('.motion-votes'),
                intro: "<%= I18n.t('intro.motion.posted.vote') %>"
            },
            {
                element: document.querySelector('.argument-columns'),
                intro: "<%= I18n.t('intro.motion.posted.post_argument') %>"
            },
            {
                element: document.querySelector('.share-menu'),
                intro: "<%= I18n.t('intro.motion.posted.share') %>"
            }
        ]
    });

    //start introJs on click
    $(document).on("click", '.intro-trigger', function() {
        introJs.start();
    });

    //Closes introJS when a new page is opened
    $(document).on('pjax:click', function() {
        introJs().exit();
    });

    //start introJs after posting an idea
    if (window.location.search.indexOf('start_motion_tour=true') > -1) {
        introJsMotionTour.start();
    }

});