<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: lib/helpers.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: lib/helpers.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import React from 'react';
React; // For ESLint, jsx compiles to React.createElement, so React must be imported
import Intl from 'intl';
Intl; // For ESLint

/**
 * @module Helpers
 */


Object.resolve = function(path, obj) {
    return [obj || self].concat(path.split('.')).reduce(function(prev, curr) {
        return prev &amp;&amp; prev[curr]
    });
};

if (!Object.assign) {
    Object.defineProperty(Object, 'assign', {
        enumerable: false,
        configurable: true,
        writable: true,
        value: function(target) {
            if (target === undefined || target === null) {
                throw new TypeError('Cannot convert first argument to object');
            }

            var to = Object(target);
            for (var i = 1; i &lt; arguments.length; i++) {
                var nextSource = arguments[i];
                if (nextSource === undefined || nextSource === null) {
                    continue;
                }
                nextSource = Object(nextSource);

                var keysArray = Object.keys(Object(nextSource));
                for (var nextIndex = 0, len = keysArray.length; nextIndex &lt; len; nextIndex++) {
                    var nextKey = keysArray[nextIndex];
                    var desc = Object.getOwnPropertyDescriptor(nextSource, nextKey);
                    if (desc !== undefined &amp;&amp; desc.enumerable) {
                        to[nextKey] = nextSource[nextKey];
                    }
                }
            }
            return to;
        }
    });
}

export function image (props) {
    if (props.image) {
        return &lt;img src={props.image.url} alt={props.image.title} className={props.image.className} />;
    } else if (props.fa) {
        return &lt;span className={['fa', props.fa].join(' ')} />;
    }
}

export function _url (url, obj) {
    if (typeof url === 'string' &amp;&amp; typeof obj === 'object') {
        var res = decodeURIComponent(url).replace(/{{([^{}]+)}}/, function (match, p1) {
            return Object.resolve(p1, obj);
        });
        return res || decodeURIComponent(url);
    } else if (url !== null) {
        return decodeURIComponent(url);
    }
}

export function _authenticityHeader (options) {
    options = options || {};
    return Object.assign(options, {
        'X-CSRF-Token': getAuthenticityToken(),
        'X-Requested-With': 'XMLHttpRequest'
    });
}

export function errorMessageForStatus(status) {
    if (status === 401) {
        return {
            'type': 'alert',
            'severity': 'error',
            'i18nString': 'errors.status.401',
            'fallback': 'Je moet ingelogd zijn voor deze actie.'
        };
    } else if (status === 404) {
        return {
            'type': 'alert',
            'severity': 'error',
            'i18nString': 'errors.status.404',
            'fallback': 'Het item is niet gevonden, probeer de pagina te verversen.'
        };
    } else if (status === 429) {
        return {
            'type': 'alert',
            'severity': 'error',
            'i18nString': 'errors.status.429',
            'fallback': 'Je maakt te veel verzoeken, probeer het over halve minuut nog eens.'
        };
    } else if (status === 500) {
        return {
            'type': 'alert',
            'severity': 'error',
            'i18nString': 'errors.status.500',
            'fallback': 'Er ging iets aan onze kant fout, probeer het later nog eens.'
        };
    } else if (status === 0) {
        return {
            'type': 'none',
            'severity': '',
            'i18nString': undefined,
            'fallback': ''
        };
    } else {
        return {
            'type': 'none',
            'severity': '',
            'i18nString': undefined,
            'fallback': undefined
        };
    }
}

export function getAuthenticityToken () {
    return getMetaContent('csrf-token');
}

export function getMetaContent (name) {
    let header = document.querySelector(`meta[name="${name}"]`);
    return header &amp;&amp; header.content;
}

export function getUserIdentityToken () {
    return {token: getMetaContent('user-identity-token')};
}


/**
 * For use with window.fetch
 */
export function jsonHeader (options) {
    options = options || {};
    return Object.assign(options, {
        'Accept': 'application/json',
        'Content-Type': 'application/json'
    });
}

/**
 * Lets fetch include credentials in the request. This includes cookies and other possibly sensitive data.
 * Note: Never use for requests across (untrusted) domains.
 */
export function safeCredentials (options) {
    options = options || {};
    return Object.assign(options, {
        credentials: 'include',
        mode: 'same-origin',
        headers: Object.assign((options['headers'] || {}), _authenticityHeader(), jsonHeader())
    });
}

export function statusSuccess (response) {
    if (response.status >= 200 &amp;&amp; response.status &lt; 300 || response.status === 304) {
        return Promise.resolve(response);
    } else {
        return Promise.reject(response);
    }
}

export function tryLogin (response) {
    if (response.status === 401) {
        return Promise.resolve(window.alert(errorMessageForStatus(response.status).fallback));
    } else {
        const message = errorMessageForStatus(response.status).fallback || 'unknown status code';
        return Promise.reject(new Error(message));
    }
}

export function userIdentityToken (options) {
    options = options || {};
    return Object.assign(options, {
        body: JSON.stringify(Object.assign((options['body'] || {}), getUserIdentityToken()))
    })
}

export function json (response) {
    if (typeof response !== 'undefined' &amp;&amp; response.status !== 204 &amp;&amp; response.status !== 304) {
        return response.json();
    } else {
        return Promise.resolve();
    }
}

</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-BigVote.html">BigVote</a></li><li><a href="module-CombiBigVote.html">CombiBigVote</a></li><li><a href="module-FollowTheLaw.html">FollowTheLaw</a></li><li><a href="module-Helpers.html">Helpers</a></li><li><a href="module-Update.html">Update</a></li></ul><h3>Classes</h3><ul><li><a href="BigVote.BigVoteButtons.html">BigVoteButtons</a></li><li><a href="BigVote.BigVoteResults.html">BigVoteResults</a></li><li><a href="DetailsPane.html">DetailsPane</a></li><li><a href="DetailsPaneContainerComponent.html">DetailsPaneContainerComponent</a></li><li><a href="Link.html">Link</a></li><li><a href="module-FollowTheLaw-Phase.html">Phase</a></li><li><a href="module-FollowTheLaw-TimeLine.html">TimeLine</a></li><li><a href="module-FollowTheLaw-TimeLineComponent.html">TimeLineComponent</a></li><li><a href="module-FollowTheLaw-TimeLineComponentContainer.html">TimeLineComponentContainer</a></li><li><a href="module-FollowTheLaw-TimeLineComponentContainerWrapper.html">TimeLineComponentContainerWrapper</a></li><li><a href="Point.html">Point</a></li><li><a href="Profile.html">Profile</a></li><li><a href="RDateline.html">RDateline</a></li><li><a href="RImage.html">RImage</a></li><li><a href="RPhase.html">RPhase</a></li><li><a href="RPoint.html">RPoint</a></li><li><a href="RProfile.html">RProfile</a></li><li><a href="RTimeline.html">RTimeline</a></li><li><a href="RUpdate.html">RUpdate</a></li></ul><h3>Global</h3><ul><li><a href="global.html#activeItem">activeItem</a></li><li><a href="global.html#activePoint">activePoint</a></li><li><a href="global.html#getMarker">getMarker</a></li><li><a href="global.html#initialState">initialState</a></li><li><a href="global.html#nextPoint">nextPoint</a></li><li><a href="global.html#previousPoint">previousPoint</a></li><li><a href="global.html#replaceDateStrings">replaceDateStrings</a></li><li><a href="global.html#reviver">reviver</a></li><li><a href="global.html#SET_ACTIVE_TIMELINE">SET_ACTIVE_TIMELINE</a></li><li><a href="global.html#setActivePoint">setActivePoint</a></li><li><a href="global.html#setActiveTimeline">setActiveTimeline</a></li><li><a href="global.html#setCurrentPhase">setCurrentPhase</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a> on Sat Jan 16 2016 15:26:46 GMT+0100 (CET)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
